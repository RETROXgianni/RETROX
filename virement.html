<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Virement bancaire — Retro X</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: #f7f8fa;
      font-family: 'Poppins', sans-serif;
      color: #222;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .payment-container {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.09);
      padding: 38px 32px 32px 32px;
      max-width: 400px;
      width: 100%;
      margin: 40px auto;
      text-align: center;
    }
    .payment-title {
      font-size: 2em;
      font-weight: 700;
      margin-bottom: 18px;
    }
    .payment-desc {
      font-size: 1.1em;
      margin-bottom: 24px;
      color: #444;
    }
    .form-label {
      font-weight: 600;
      margin-bottom: 6px;
      display: block;
      text-align: left;
    }
    .form-input {
      width: 100%;
      padding: 10px;
      margin-bottom: 14px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-family: inherit;
      font-size: 1em;
      box-sizing: border-box;
    }
    .submit-btn {
      background: #222;
      color: #fff;
      font-weight: 700;
      font-size: 1.1em;
      border: none;
      border-radius: 10px;
      padding: 14px 0;
      width: 100%;
      max-width: 320px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
      transition: background 0.2s;
      margin-bottom: 10px;
    }
    .submit-btn:hover {
      background: #444;
    }
    .bank-details {
      background: #f7f8fa;
      border-radius: 10px;
      padding: 14px;
      margin-bottom: 18px;
      font-size: 1em;
      color: #222;
      text-align: left;
    }
    .info {
      font-size: 0.95em;
      color: #888;
      margin-top: 12px;
      text-align: left;
    }
    @media (max-width: 600px) {
      .payment-container {
        border-radius: 0;
        box-shadow: none;
        padding: 18px 8px 24px 8px;
        max-width: 100vw;
      }
      .payment-title {
        font-size: 1.3em;
      }
    }
  </style>
</head>
<body>
  <div class="payment-container">
    <div class="payment-desc">
      <strong style="font-size:1.35em;display:block;">Précommandez votre vinyle Cortege Royal — Retro X</strong>.<br>
      Édition limitée à 100 exemplaires.<br><br>
      Prix : <strong>49,99€</strong> (ttc)
    </div>
    <form id="paypal-form">
      <label class="form-label" for="nom">Nom complet</label>
      <input class="form-input" type="text" id="nom" name="nom" required>
      <label class="form-label" for="email">Email</label>
      <input class="form-input" type="email" id="email" name="email" required>
      <label class="form-label" for="adresse">Adresse complète </label>
      <textarea class="form-input" id="adresse" name="adresse" rows="3" required></textarea>
      <div id="paypal-button-container" style="margin: 18px 0;"></div>
    </form>
    <div class="info">
      Après paiement, tu recevras un email de confirmation.<br>
      Dès réception du paiement, le vinyle sera expédié à l'adresse indiquée suite à sa production.
    </div>
    <!-- À placer dans ta page virement.html à la place du bouton SDK -->
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" style="margin:18px 0;">
  <input type="hidden" name="cmd" value="_xclick">
  <input type="hidden" name="business" value="Retrox.contact@gmail.com">
  <input type="hidden" name="item_name" value="Précommande Vinyle Cortege Royal — Retro X">
  <input type="hidden" name="amount" value="49.99">
  <input type="hidden" name="currency_code" value="EUR">
  <button type="submit" style="background:#ffc439;color:#222;font-weight:700;font-size:1.1em;padding:0.7em 2em;border-radius:8px;border:none;cursor:pointer;">
    Continuer
  </button>
</form>
    <p style="font-size:0.98em;color:#e60808;margin-top:10px;">
      Merci d’indiquer votre <b>nom</b> et <b>adresse postale</b> dans le message du paiement ou par email à <a href="mailto:Retrox.contact@gmail.com">Cykavizion@gmail.com</a>
    </p>
  </div>

  <!-- Intégration PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=TON_CLIENT_ID_PAYPAL&currency=EUR"></script>
  <script>
    // Empêche la soumission classique du formulaire
    document.getElementById('paypal-form').addEventListener('submit', function(e) {
      e.preventDefault();
    });

    paypal.Buttons({
      createOrder: function(data, actions) {
        // Vérifie que les champs sont remplis
        const nom = document.getElementById('nom').value.trim();
        const email = document.getElementById('email').value.trim();
        const adresse = document.getElementById('adresse').value.trim();
        if (!nom || !email || !adresse) {
          alert('Merci de remplir tous les champs avant de payer.');
          return false;
        }
        // Stocke les infos dans le localStorage pour la suite (ou à envoyer à un serveur)
        localStorage.setItem('commande_nom', nom);
        localStorage.setItem('commande_email', email);
        localStorage.setItem('commande_adresse', adresse);

        return actions.order.create({
          purchase_units: [{
            amount: { value: '49.99', currency_code: 'EUR' },
            description: 'Précommande vinyle Cortege Royal — Retro X'
          }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          const nom = localStorage.getItem('commande_nom');
          const email = localStorage.getItem('commande_email');
          const adresse = localStorage.getItem('commande_adresse');

          // Envoi automatique via EmailJS
          emailjs.send("service_8ajs8l4", "template_b6ziwri", {
            nom: nom,
            email: email,
            adresse: adresse,
            montant: "49.99",
            image_url: "https://retroxgianni.github.io/RETROX/vinylevitrine.png"
          }).then(function(response) {
            alert('Merci ' + nom + ' ! Paiement reçu. Nous expédierons le vinyle à :\n' + adresse + '\nUn email de confirmation sera envoyé à : ' + email);
          }, function(error) {
            alert('Paiement reçu, mais une erreur est survenue lors de l\'envoi de l\'email.');
          });

          // Nettoie le localStorage
          localStorage.removeItem('commande_nom');
          localStorage.removeItem('commande_email');
          localStorage.removeItem('commande_adresse');
        });
      }
    }).render('#paypal-button-container');
  </script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function(){
      emailjs.init("BFA68ksxg8-O7WYEi"); // Remplace par ta clé publique EmailJS
    })();
  </script>
</body>
</html>
